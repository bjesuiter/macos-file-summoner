---
# macos-file-summoner-xz9e
title: 'Fix security vulnerability: eval() in notarize script'
status: completed
type: bug
priority: high
created_at: 2026-01-21T12:17:12Z
updated_at: 2026-01-21T20:18:49Z
---

SECURITY: scripts/03-notarize.sh line 49 uses eval() with user-controlled variables, allowing command injection.

## Problem
```bash
eval $NOTARY_CMD  # DANGEROUS
```

## Solution
Use array instead of eval:
```bash
NOTARY_CMD=(xcrun notarytool submit "${MACOS_APP_ZIP}" 
    --apple-id "${APPLE_DEVELOPER_ID_NAME}" 
    --password "${APPLE_ACCOUNT_APP_PASSWORD}" 
    --wait)

if [ -n "$APPLE_TEAM_ID" ]; then
    NOTARY_CMD+=(--team-id "${APPLE_TEAM_ID}")
fi

"${NOTARY_CMD[@]}"  # Safe execution
```

## Files
- scripts/03-notarize.sh:41-49